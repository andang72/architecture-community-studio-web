<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title><%= title %></title>
  <style>
    #loader {
      transition: all 0.3s ease-in-out;
      opacity: 1;
      visibility: visible;
      position: fixed;
      height: 100vh;
      width: 100%;
      background: #fff;
      z-index: 90000;
    }

    #loader.fadeOut {
      opacity: 0;
      visibility: hidden;
    }

    .spinner {
      width: 40px;
      height: 40px;
      position: absolute;
      top: calc(50% - 20px);
      left: calc(50% - 20px);
      background-color: #333;
      border-radius: 100%;
      -webkit-animation: sk-scaleout 1.0s infinite ease-in-out;
      animation: sk-scaleout 1.0s infinite ease-in-out;
    }

    @-webkit-keyframes sk-scaleout {
      0% {
        -webkit-transform: scale(0)
      }

      100% {
        -webkit-transform: scale(1.0);
        opacity: 0;
      }
    }

    @keyframes sk-scaleout {
      0% {
        -webkit-transform: scale(0);
        transform: scale(0);
      }

      100% {
        -webkit-transform: scale(1.0);
        transform: scale(1.0);
        opacity: 0;
      }
    }

    .k-grid .u-link-underline>h5,
    .k-grid .u-link-underline>h4,
    .k-grid .u-link-underline>.u-title {
      border-bottom: 1px solid transparent;
      padding-bottom: 1.5px;
    }

    .is-loading {
      background-color: #fff;
      background-image: url('assets/static/images/loading-image.gif');
      background-repeat: no-repeat;
      background-position: center;
    }

    .is-loading img,
    .is-broken img {
      opacity: 0;
    }

    .tab-pane-grid .k-grid-toolbar {
      background: #fff;
    }

    .dropZoneElement {
      position: relative;
      display: inline-block;
      background-color: #f8f8f8;
      border: 1px solid rgba(0, 0, 0, .08);
      width: 100%;
      height: 110px;
      text-align: center;
    }

    .textWrapper {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 100%;
      font-size: 24px;
      line-height: 1.2em;
      font-family: Arial, Helvetica, sans-serif;
      color: #000;
    }

    .dropImageHereText {
      color: #c7c7c7;
      text-transform: uppercase;
      font-size: 12px;
    }

    #attachment-thumbnail-image {
      min-height: 150px;
      min-width: 150px;
    }
  </style>
</head>

<body class="app" authenticate-required="true">
  <!-- @TOC -->
  <!-- =================================================== -->
  <!--
      + @Page Loader
      + @App Content
          - #Left Sidebar
              > $Sidebar Header
              > $Sidebar Menu

          - #Main
              > $Topbar
              > $App Screen Content
    -->

  <!-- @Page Loader -->
  <!-- =================================================== -->
  <div id='loader'>
    <div class="spinner"></div>
  </div>

  <script>
    window.addEventListener('load', function load() {
      const loader = document.getElementById('loader');
      setTimeout(function () {
        loader.classList.add('fadeOut');
      }, 300);
    });
  </script>

  <!-- @App Content -->
  <!-- =================================================== -->
  <div>
    <!-- #Left Sidebar ==================== -->
    <div class="sidebar">
      <div class="sidebar-inner">
        <!-- ### $Sidebar Header ### -->
        <div class="sidebar-logo">
          <div class="peers ai-c fxw-nw">
            <div class="peer peer-greed">
              <a class="sidebar-link td-n" href="index.html">
                <div class="peers ai-c fxw-nw">
                  <div class="peer">
                    <div class="logo">
                      <img src="assets/static/images/logo.png" alt="">
                    </div>
                  </div>
                  <div class="peer peer-greed">
                    <h5 class="lh-1 mB-0 logo-text">Adminator</h5>
                  </div>
                </div>
              </a>
            </div>
            <div class="peer">
              <div class="mobile-toggle sidebar-toggle">
                <a href="" class="td-n">
                  <i class="ti-arrow-circle-left"></i>
                </a>
              </div>
            </div>
          </div>
        </div>

        <!-- ### $Sidebar Menu ### -->
        <ul class="sidebar-menu scrollable pos-r">
          <li class="nav-item  mT-30">
            <a class="sidebar-link" href="index.html">
              <span class="icon-holder">
                <i class="c-blue-500 ti-home"></i>
              </span>
              <span class="title">Dashboard</span>
            </a>
          </li>
          <li class="nav-item dropdown">
            <a class="dropdown-toggle" href="javascript:void(0);">
              <span class="icon-holder">
                <i class="c-orange-500 ti-folder"></i>
              </span>
              <span class="title">Settings</span>
              <span class="arrow">
                <i class="ti-angle-right"></i>
              </span>
            </a>
            <ul class="dropdown-menu">
              <li>
                <a class='sidebar-link ' href="settings-properties.html">Properties</a>
              </li>
              <li>
                <a class='sidebar-link' href="settings-locale.html">Locale</a>
              </li>
              <li>
                <a class='sidebar-link' href="settings-datasource.html">DataSource</a>
              </li>
            </ul>
          </li>
          <li class="nav-item dropdown">
            <a class="dropdown-toggle" href="javascript:void(0);">
              <span class="icon-holder">
                <i class="c-deep-orange-500 ti-folder"></i>
              </span>
              <span class="title">Security</span>
              <span class="arrow">
                <i class="ti-angle-right"></i>
              </span>
            </a>
            <ul class="dropdown-menu">
              <li>
                <a class='sidebar-link' href="security-perms.html">Roles & Permissions</a>
              </li>
              <li>
                <a class='sidebar-link' href="security-users.html">Users</a>
              </li>
              <li>
                <a class='sidebar-link' href="security-audit.html">Audit</a>
              </li>
            </ul>
          </li>
          <li class="nav-item dropdown">
            <a class="dropdown-toggle" href="javascript:void(0);">
              <span class="icon-holder">
                <i class="c-green-500 ti-folder"></i>
              </span>
              <span class="title">Services</span>
              <span class="arrow">
                <i class="ti-angle-right"></i>
              </span>
            </a>
            <ul class="dropdown-menu">
              <li>
                <a class='sidebar-link' href="services-email.html">Email</a>
              </li>
              <li>
                <a class='sidebar-link' href="services-sequencer.html">Sequencer</a>
              </li>
              <li>
                <a class='sidebar-link' href="services-viewcount.html">View Count</a>
              </li>
              <li>
                <a class='sidebar-link' href="services-menu.html">Menu</a>
              </li> 
            </ul>
          </li>
          <li class="nav-item dropdown open">
            <a class="dropdown-toggle" href="javascript:void(0);">
              <span class="icon-holder">
                <i class="c-purple-500 ti-folder"></i>
              </span>
              <span class="title">Resources</span>
              <span class="arrow">
                <i class="ti-angle-right"></i>
              </span>
            </a>
            <ul class="dropdown-menu">
              <li>
                <a class='sidebar-link' href="resources-pages.html">Pages</a>
              </li>
              <li>
                <a class='sidebar-link' href="resources-apis.html">Apis</a>
              </li>

              <li class="nav-item dropdown">
                <a href="javascript:void(0);">
                  <span>Sources</span>
                  <span class="arrow">
                    <i class="ti-angle-right"></i>
                  </span>
                </a>
                <ul class="dropdown-menu">
                  <li>
                    <a href="resources-decorators.html">Decorators</a>
                  </li>
                  <li>
                    <a href="resources-templates.html">Templates</a>
                  </li>
                  <li>
                    <a href="resources-groovys.html">Gloovy</a>
                  </li>
                  <li>
                    <a href="resources-sqls.html">Sql</a>
                  </li>
                </ul>
              </li>
              <li>
                <a class='sidebar-link actived' href="resources-files.html">Files</a>
              </li>
              <li>
                <a class='sidebar-link ' href="resources-images.html">Images</a>
              </li>
            </ul>
          </li>
        </ul>
      </div>
    </div>

    <!-- #Main ============================ -->
    <div class="page-container">
      <!-- ### $Topbar ### -->
      <%= require('html-loader!./include-topbar.html') %>

      <!-- ### $App Screen Content ### -->
      <script>
        function setup() {
          $(document).ajaxSend(function (event, jqXHR, options) {
            jqXHR.setRequestHeader('Authorization', studio.services.accounts.authHeader()['Authorization']);
          });
          var $window = $(window).on('resize', function () {
            var height = $(document).height() - ($('.header-container').height() + 61)
            $('#grid').height(height);
          }).trigger('resize'); //on page load     
          const headers = {
            Accept: "application/json",
            "Content-Type": "application/json"
          };
          Object.assign(headers, studio.services.accounts.authHeader());
          var renderTo = $("#mainContent");
          var observable = kendo.observable({
            selected: false,
            selectedImages: null,
            upload: function () {
              getAttachmentEditorWindow();
            },
            delete: function (e) {
              var $this = this;
              var selected = $('#grid').data('kendoGrid').dataSource.view();
              var template = kendo.template('Permanently remove the selected image.<br/> Moves cannot be minimized.');
              var dialog = $("#delete-dialog").kendoDialog({
                title: 'Are you sure you want to delete the image?',
                content: template($this),
                actions: [
                  {
                    text: 'Ok',
                    action: function (e) {
                      kendo.ui.progress($('.k-dialog'), true);
                      axios({
                        url: studio.services.getApiUrl('/data/secure/mgmt/images/delete.json'),
                        method: "post",
                        data: JSON.stringify(selected),
                        headers: headers
                      })
                        .then(response => {
                          const data = response.data;
                          $('#grid').data('kendoGrid').dataSource.read();
                          studio.ui.notify(null, data.count + "image has been deleted.", "success");
                        }).catch(function (error) {
                          studio.ui.handleAxiosError(error);
                        })
                        .then(function () {
                          kendo.ui.progress($('.k-dialog'), false);
                          dialog.close();
                        });
                      return false;
                    },
                    primary: true
                  },
                  { text: 'Cancle' }
                ]
              }).data('kendoDialog');
              dialog.open();
            }
          });
          createAttachmentsGrid(observable);
          kendo.bind(renderTo, observable);
        }

        function createAttachmentsGrid(observable) {
          var renderTo = $('#grid');
          if (!renderTo.data('kendoGrid')) {
            var grid = renderTo.kendoGrid({
              dataSource: {
                transport: {
                  read: { url: studio.services.getApiUrl('/data/secure/mgmt/attachments/list.json?fields=link,tags'), type: 'post', contentType: "application/json; charset=utf-8" },
                  parameterMap: function (options, operation) {
                    if (operation !== "read" && options.models) {
                      return JSON.stringify(options.models);
                    }
                    return JSON.stringify(options);
                  }
                },
                pageSize: 50,
                serverPaging: true,
                serverFiltering: true,
                serverSorting: true,
                error: studio.ui.handleAjaxError,
                schema: {
                  total: "totalCount",
                  data: "items",
                  model: studio.data.model.Attachment
                }
              },
              toolbar: [{ name: "create", text: "Upload new file", template: kendo.template($('#grid-toolbar-template').html()) }],
              sortable: true,
              persistSelection: true,
              filterable: true,
              pageable: {
                refresh: true,
                pageSizes: [50, 100, 200, 300, 400]
              },
              change: function (e) {
                if (this.selectedKeyNames().length > 0) {
                  observable.set('selected', true);
                } else {
                  observable.set('selected', false);
                }
              },
              dataBound: function () {
                $(".fancybox").fancybox({
                  protect: false
                });

                $("#grid figure img:not([is-secure])").one("load", function () {
                  var $this = $(this);
                  $this.parent().removeClass('is-loading');
                }).each(function () {
                  if (this.complete) {
                    // $(this).load(); // For jQuery < 3.0 
                    // $(this).trigger('load'); // For jQuery >= 3.0 
                  }
                });
                $("#grid figure img[is-secure]").each(function () {
                  var $this = $(this);
                  $this.parent().addClass('is-loading');
                  setImageAsBase64($this);
                });
              },
              columns: [
                { selectable: true, width: "50px", headerAttributes: {} },
                { field: "ATTACHMENT_ID", title: "ID", filterable: false, sortable: true, width: 80, template: '#= attachmentId #', attributes: { class: "text-center" } },
                { field: "OBJECT_TYPE", title: "OBJECT TYPE", filterable: true, sortable: true, width: 120, template: '#= objectType #', attributes: { class: "text-center" } },
                { field: "OBJECT_ID", title: "OBJECT ID", filterable: true, sortable: true, width: 120, template: '#= objectId #', attributes: { class: "text-center" } },
                { field: "NAME", title: "NAME", filterable: true, sortable: true, template: $('#name-column-template').html() },
                { field: "FILE_SIZE", title: "Size", filterable: false, sortable: true, template: '#: studio.ui.format.byte(size)  #', attributes: { class: "text-center" }, width: 120 },
                { field: "CONTENT_TYPE", title: "Content Type", filterable: false, sortable: false, width: 120, template: '#= contentType #', attributes: { class: "text-center" } },
                { field: "USER_ID", title: "Creator", filterable: false, sortable: true, width: 150, template: $('#user-column-template').html(), attributes: { class: "text-center" } },
                { field: "CREATION_DATE", title: "Creation Date", filterable: false, sortable: true, width: 100, template: '#: studio.ui.format.date( creationDate ,"yyyy.MM.dd")#', attributes: { class: "text-center" } },
                { field: "MODIFIED_DATE", title: "Modified Date", filterable: false, sortable: true, width: 100, template: '#: studio.ui.format.date( modifiedDate ,"yyyy.MM.dd")#', attributes: { class: "text-center" } }
              ]
            }).data('kendoGrid');

            renderTo.on("click", "a[data-action=edit]", function (e) {
              var $this = $(this);
              if (studio.ui.defined($this.data("object-id"))) {
                var objectId = $this.data("object-id");
                var dataItem = grid.dataSource.get(objectId);
                getAttachmentEditorWindow(dataItem);
              }
            });
          }
        }

        function setImageAsBase64(elemment) {
          let url = elemment.attr('secure-image');
          studio.ui.setImageAsBase64(url, function (data) {
            elemment.attr('src', data);
            elemment.parent().removeClass('is-loading');
          }, function(){
            let retry = elemment.data('retry') || 0 ;
            console.log( retry + ' loading image ' + url )
            if( retry < 3 ){
              elemment.data('retry', retry + 1  );
              studio.ui.sleep(1000);
              setImageAsBase64(elemment);
            }else{
              elemment.parent().removeClass('is-loading');
            }
          });
        }

        function getAttachmentEditorWindow(item) {
          var renderTo = $('#attachment-window');
          if (!renderTo.data("kendoWindow")) {
            var AttachmentModel = kendo.data.Model.define(studio.data.model.Attachment);
            const headers = {
              Accept: "application/json",
              "Content-Type": "application/json"
            };
            Object.assign(headers, studio.services.accounts.authHeader());
            var grid = $('#grid').data('kendoGrid');
            var observable = kendo.observable({
              updated: false,
              attachment: new AttachmentModel(),
              imageUrl: 'assets/static/images/no-image.jpg',
              editable: false,
              shared: false,
              imageByUrl: {
                url: null,
                imageUrl: null,
                uploadable: false
              },
              selectedTags: [],
              previewUrlImage: function () {
                var $this = this;
                if ($this.get('imageByUrl.url') != null) {
                  $('#image-preview-area').parent().addClass('is-loading');
                  $.get($this.get('imageByUrl.url')).done(
                    function () {
                      $this.set('imageByUrl.imageUrl', $this.get('imageByUrl.url'));
                      $('#image-preview-area').parent().removeClass('is-loading');
                    }).fail(function () {
                      $this.set('imageByUrl.imageUrl', $this.get('imageByUrl.url'));
                      $('#image-preview-area').parent().removeClass('is-loading');
                    });
                  $this.set('imageByUrl.uploadable', true);
                }
              },
              uploadImageByUrl: function () {
                var $this = this;
                kendo.ui.progress(renderTo, true);
                axios({
                  url: studio.services.getApiUrl('/data/secure/mgmt/images/upload_by_url.json'),
                  method: 'post',
                  headers: headers,
                  data: JSON.stringify(
                    {
                      objectType: $this.get('image.objectType'),
                      objectId: $this.get('image.objectId'),
                      imageUrl: $this.get('imageByUrl.url'),
                      share: $this.get('shared'),
                      imageId: $this.get('image.imageId')
                    }
                  )
                }).then(response => {
                  $this.setSource(new ImageModel(response.data));
                  renderTo.data("kendoWindow").title(observable.image.name);
                  observable.set('updated', true);
                }).catch(error => {
                  studio.ui.handleAxiosError(error);
                }).then(function () {
                  kendo.ui.progress(renderTo, false);
                });
              },
              getSharedLink: function () {
                var $this = this;
                if ($this.attachment.attachmentId > 0) {
                  kendo.ui.progress(renderTo, true);
                  axios({
                    url: studio.services.getApiUrl('/data/secure/mgmt/attachments/') + $this.attachment.attachmentId + '/link.json?create=true',
                    method: 'post',
                    headers: headers,
                    data: JSON.stringify({})
                  }).then(response => {
                    $this.set("attachment.sharedLink", response.data);
                    $this.set("shared", true);
                    observable.set('updated', true);
                  }).catch(error => {
                    studio.ui.handleAxiosError(error);
                  }).then(function () {
                    kendo.ui.progress(renderTo, false);
                  });
                }
                return false;
              },
              deleteSharedLink: function () {
                var $this = this;
                if ($this.attachment.attachmentId > 0) {
                  kendo.ui.progress(renderTo, true);
                  axios({
                    url: studio.services.getApiUrl('/data/secure/mgmt/attachments/') + $this.attachment.attachmentId + '/delete-link.json',
                    method: 'post',
                    headers: headers,
                    data: JSON.stringify({})
                  }).then(response => {
                    $this.attachment.sharedLink = null;
                    $this.set("shared", false);
                    observable.set('updated', true);
                  }).catch(error => {
                    studio.ui.handleAxiosError(error);
                  }).then(function () {
                    kendo.ui.progress(renderTo, false);
                  });
                }
                return false;
              },
              saveOrUpdateTags: function () {
                var $this = this;
                var objectIds = [];
                objectIds.push($this.attachment.attachmentId);
                kendo.ui.progress(renderTo, true);
                axios({
                  url: studio.services.getApiUrl('/data/secure/mgmt/services/tags/0/objects/save-or-update.json'),
                  method: 'post',
                  headers: headers,
                  data: JSON.stringify({ objectType: 10, objectIds: objectIds, tagIds: $this.selectedTags }),
                }).then(response => {
                  studio.ui.notify(null, "tags has been updated.", "success");
                  observable.set('updated', true);
                }).catch(error => {
                  studio.ui.handleAxiosError(error);
                }).then(function () {
                  kendo.ui.progress(renderTo, false);
                });
              },
              saveOrUpdate: function () {
                var $this = this;
                if ($this.get('shared')) {
                  $this.getSharedLink();
                } else {
                  $this.deleteSharedLink();
                }
                kendo.ui.progress(renderTo, true);
                axios({
                  url: studio.services.getApiUrl('/data/secure/mgmt/attachments/save-or-update.json'),
                  method: 'post',
                  headers: headers,
                  data: JSON.stringify($this.attachment)
                }).then(response => {
                  $this.setSource(new AttachmentModel(response.data));
                  observable.set('updated', true);
                }).catch(error => {
                  studio.ui.handleAxiosError(error);
                }).then(function () {
                  kendo.ui.progress(renderTo, false);
                });
              },
              objectTypeDataSource: kendo.data.DataSource.create({
                transport: {
                  read: { url: studio.services.getApiUrl('/data/secure/mgmt/services/sequencers/list.json'), type: 'post', contentType: "application/json; charset=utf-8" },
                  parameterMap: function (options, operation) {
                    return JSON.stringify(options);
                  }
                },
                schema: {
                  total: "totalCount",
                  data: "items",
                  model: {
                    id: "sequencerId",
                    fields: {
                      sequencerId: { type: "number", defaultValue: 0 },
                      name: { type: "string" },
                      displayName: { type: "string" },
                      value: { type: "number", defaultValue: 0 }
                    }
                  }
                }
              }),
              setSource: function (data) {
                var $this = this;
                data = data || new AttachmentModel();
                data.copy($this.attachment);
                $this.set('editable', $this.attachment.attachmentId > 0 ? true : false);
                $this.set('imageByUrl.url', null);
                $this.set('imageByUrl.imageUrl', 'assets/static/images/no-image.jpg');
                $this.set('imageByUrl.uploadable', false);
                if ($this.get('editable')) {
                  if ($this.attachment.tags != null && $this.attachment.tags.length > 0) {
                    var ar = $this.attachment.tags.split(',');
                    $.each(ar, function (index, _tag) {
                      $('#select-tags').data('kendoMultiSelect').dataSource.fetch(function () {
                        var data = this.data();
                        $.each(data, function (index, value) {
                          if (value.name = _tag.trim()) {
                            $this.get('selectedTags').push(value.tagId);
                            return false;
                          }
                        });
                      });
                    });
                  }
                  $this.set("imageUrl", studio.ui.getAttachmentUrl($this.attachment, { thumbnail: true }));
                  if ($this.attachment.sharedLink != null && $this.attachment.sharedLink.linkId != null) {
                    $this.set('shared', true);
                  } else {
                    $this.set('shared', false);
                    $('#attachment-thumbnail-image').addClass('is-loading');
                    studio.ui.getImageAsBase64($this.get("imageUrl"), function (data) {
                      $this.set("imageUrl", data);
                      $('#attachment-thumbnail-image').removeClass('is-loading');
                    });
                  }
                  createPropertyWindowIfNotExist(null, data.attachmentId);
                } else {
                  $this.set('imageUrl', 'assets/static/images/no-image.jpg');
                }
              }
            });

            var select = $('#select-tags').kendoMultiSelect({
              filter: "startswith",
              valuePrimitive: true,
              placeholder: 'Select tags...',
              dataTextField: "name",
              dataValueField: "tagId",
              dataSource: {
                transport: {
                  read: { url: studio.services.getApiUrl('/data/secure/mgmt/services/tags/list.json'), type: 'post', contentType: "application/json; charset=utf-8" },
                  create: { url: studio.services.getApiUrl('/data/secure/mgmt/services/tags/0/create.json'), type: 'post', contentType: "application/json; charset=utf-8" },
                  parameterMap: function (options, operation) {
                    return kendo.stringify(options);
                  }
                },
                schema: {
                  total: "totalCount",
                  data: "items",
                  model: {
                    id: "tagId",
                    fields: {
                      tagId: { type: "number", defaultValue: 0 },
                      name: { type: "string", defaultValue: null }
                    }
                  }
                }
              },
              noDataTemplate: $('#no-tag-data-template').html()
            }).data('kendoMultiSelect');

            $("#dropZone").kendoUpload({
              async: {
                saveUrl: studio.services.getApiUrl('/data/secure/mgmt/attachments/upload.json'),
                autoUpload: true
              },
              upload: function (e) {
                e.data = {
                  objectType: observable.get("attachment.objectType"),
                  objectId: observable.get("attachment.objectId"),
                  imageId: observable.get("attachment.attachmentId")
                };
              },
              success: function (e) {
                const data = e.response;
                observable.setSource(new AttachmentModel(data[0]));
                renderTo.data("kendoWindow").title(observable.attachment.name);
                observable.set('updated', true);
              },
              multiple: false,
              showFileList: false,
              localization: {
                dropFilesHere: "DROP FILE HERE TO UPLOAD"
              }
              //dropZone: ".dropZoneElement"
            });

            kendo.bind(renderTo, observable);
            renderTo.data('model', observable);
            var window = renderTo.kendoWindow({
              width: "900px",
              title: "Image",
              visible: false,
              scrollable: true,
              modal: true,
              actions: ["Close"], // 
              open: function () {
                this.title(observable.attachment.name);
                observable.set('updated', false);
              },
              close: function () {
                if (observable.get('updated'))
                  grid.dataSource.read();
              }
            }).data('kendoWindow');
          }
          renderTo.data('model').setSource(item);
          renderTo.data("kendoWindow").center().open();
        }

        function createPropertyWindowIfNotExist(renderTo, objectId) {
          renderTo = renderTo || $('#property-grid');
          if (!renderTo.data("kendoGrid")) {
            var grid = renderTo.kendoGrid({
              dataSource: [],
              height: 400,
              sortable: true,
              filterable: false,
              pageable: false,
              editable: "inline",
              columns: [
                { field: "name", title: "Name", width: 250, validation: { required: true } },
                { field: "value", title: "Value", validation: { required: true } },
                { command: ["destroy"], title: "&nbsp;", width: "250px" }
              ],
              toolbar: kendo.template('<a href="\\#"class="btn u-btn-outline-lightgray g-mr-5 k-grid-add"><span class="k-icon k-i-plus"></span>Add Property</a><a href="\\#"class="btn u-btn-outline-lightgray g-mr-5 k-grid-save-changes"><span class="k-icon k-i-check"></span> Save</a><a href="\\#"class="btn u-btn-outline-lightgray g-mr-5 k-grid-cancel-changes"><span class="k-icon k-i-cancel"></span> Cancle</a><a class="pull-right hs-admin-reload u-link-v5 g-font-size-20 g-color-gray-light-v3 g-color-secondary--hover g-mt-7 g-mr-5" data-kind="properties" data-action="refresh"></a>'),
              save: function () {
              }
            }).data("kendoGrid");

            renderTo.on("click", "a[data-kind=properties],a[data-action=refresh]", function (e) {
              var $this = $(this);
              grid.dataSource.read();
            });
          }
          renderTo.data("kendoGrid").setDataSource(
            new kendo.data.DataSource(
              {
                transport: {
                  read: { url: studio.services.getApiUrl('/data/secure/mgmt/attachments/') + objectId + '/properties/list.json', type: 'post', contentType: "application/json" },
                  create: { url: studio.services.getApiUrl('/data/secure/mgmt/attachments/') + objectId + '/properties/update.json', type: 'post', contentType: "application/json" },
                  update: { url: studio.services.getApiUrl('/data/secure/mgmt/attachments/') + objectId + '/properties/update.json', type: 'post', contentType: "application/json" },
                  destroy: { url: studio.services.getApiUrl('/data/secure/mgmt/attachments/') + objectId + '/properties/delete.json', type: 'post', contentType: "application/json" },
                  parameterMap: function (options, operation) {
                    if (operation !== "read" && options.models) {
                      return JSON.stringify(options.models);
                    }
                    return JSON.stringify(options);
                  }
                },
                batch: true,
                schema: {
                  model: {
                    id: "name",
                    fields: {
                      name: { type: "string", defaultValue: "" },
                      value: { type: "string", defaultValue: "" }
                    }
                  }
                }
              }
            )
          );
        }
        function addNewTag(widgetId, value) {
          var widget = $("#" + widgetId).getKendoMultiSelect();
          var dataSource = widget.dataSource;
          if (confirm("Are you sure?")) {
            dataSource.add({ tagId: 0, name: value });
            dataSource.one("requestEnd", function (args) {
              if (args.type !== "create") {
                return;
              }
              var newValue = args.tagId;
              dataSource.one("sync", function () {
                widget.value(widget.value().concat([newValue]));
              });
            });
            dataSource.sync();
          }
        }        
      </script>
      <main class='main-content bgc-grey-100'>
        <div id='mainContent'>
          <div class="full-container">
            <div id="grid" style="border:0;"></div>
          </div>
        </div>
      </main>
      <span id="delete-dialog"></span>
      <div id="attachment-window" class="g-pa-0 g-height-600 container-fluid" style="display:none;">
        <div class="g-pa-15 g-pa-30--sm">
          <div class="row align-items-end">
            <div class="col-sm-4">
              <figure class="g-width-200" id="attachment-thumbnail-image">
                <img class="img-fluid g-brd-2 g-brd-transparent g-brd-lightblue-v3--parent-opened g-mr-20--sm"
                  src="assets/static/images/no-image.jpg" data-bind="attr:{src: imageUrl }">
              </figure>
            </div>
            <div class="col-sm-8">
              <div class="row row-cols-2 align-items-end">
                <div class="col">
                  <div class="form-group">
                    <label class="g-mb-10 g-font-weight-300">OBEJCT TYPE</label>
                    <div class="form-group g-pos-rel g-rounded-4 mb-0 g-mr-10">
                      <input data-role="dropdownlist" data-option-label="서비스를 소유하는 객체 유형을 선택하세요." data-auto-bind="true"
                        data-value-primitive="true" data-text-field="name" data-value-field="sequencerId"
                        data-bind="value:attachment.objectType, source: objectTypeDataSource" style="width: 100%;" />
                    </div>
                  </div>
                </div>
                <div class="col">
                  <div class="form-group">
                    <label class="g-mb-10 g-font-weight-300">OBEJCT ID</label>
                    <div class="form-group g-pos-rel g-rounded-4 mb-0 g-mr-10">
                      <input data-role="numerictextbox" data-format="######" data-min="0"
                        data-bind="value:attachment.objectId" style="width: 180px">
                    </div>
                  </div>
                </div>
                <div class="col-8">
                  <div class="form-check g-mt-20">
                    <label class="d-flex align-items-center justify-content-between g-mb-0">
                      <span class="g-pr-20 g-font-weight-500">Share</span>
                      <div class="u-check">
                        <input class="g-hidden-xs-up g-pos-abs g-top-0 g-right-0" name="api-enabled" id="api-enabled"
                          value="true" data-bind="checked: shared" type="checkbox">
                        <div class="u-check-icon-radio-v8">
                          <i class="fa" data-check-icon=""></i>
                        </div>
                      </div>
                    </label>
                    <small class="g-font-weight-300 g-font-size-12 g-color-gray-dark-v6 g-pt-5 g-hidden-md-down">
                      공유링크를 같이 생성합니다.
                    </small>
                  </div>
                </div>
                <div class="col g-mt-25">
                  <button class="btn btn-md u-btn-outline-blue g-rounded-50 g-mr-10 g-mb-15"
                    data-bind="visible:editable, click:saveOrUpdate">Update</button> 
                  <button class="btn-md g-pos-abs g-right-20 btn u-btn-outline-red g-rounded-50 g-mr-10 g-mb-15"
                    data-bind="visible:editable">
                    <svg class="bi bi-trash" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                      <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                      <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                    </svg>
                    Clear cache
                  </button>
                </div> 
              </div>
            </div>
          </div>
          <hr class="g-brd-gray-light-v4 g-mx-minus-30" />
          <div class="row align-items-end">
            <div class="col-sm-4">
              <img
                src="data:image/png;base64,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">
              <input name="dropZone" id="dropZone" type="file" />
            </div>
            <!--
            <div class="col-sm-8">
              <div class="row row-cols-2">
                <div class="col-6">
                  <figure class="figure g-width-200">
                    <img id="image-preview-area" data-bind="attr:{src:imageByUrl.imageUrl}"
                      class="figure-img img-fluid rounded" alt="...">
                    <figcaption class="figure-caption">.</figcaption>
                  </figure>
                </div>
                <div class="col-6"></div>
                <div class="col-12">
                  <div class="input-group">
                    <input type="text" class="form-control g-brd-gray-light-v7 g-brd-gray-light-v3 g-px-14 g-py-10"
                      data-bind="value:imageByUrl.url" placeholder="URL" aria-label="이미지 URL를 입력하세요.">
                    <div class="input-group-append">
                      <button class="btn u-btn-darkgray g-width-80" type="button"
                        data-bind="click:previewUrlImage">Preview</button>
                      <button class="btn u-btn-primary g-width-80 g-brd-0 g-rounded-right-4" type="button"
                        data-bind="click:uploadImageByUrl, enabled:imageByUrl.uploadable">Upload</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>-->
          </div>
        </div>
        <nav data-bind="visible:editable">
          <div class="nav nav-tabs" id="nav-tab" role="tablist">
            <a class="nav-item nav-link g-ml-15 active" id="nav-info-tab" data-toggle="tab" href="#nav-info" role="tab"
              aria-controls="nav-info" aria-selected="true">Info</a>
            <a class="nav-item nav-link" id="nav-property-tab" data-toggle="tab" href="#nav-property" role="tab"
              aria-controls="nav-property" aria-selected="false">Prpperties</a>
            <a class="nav-item nav-link" id="nav-permission-tab" data-toggle="tab" href="#nav-permission" role="tab"
              aria-controls="nav-permission" aria-selected="false">Permissions</a>
          </div>
        </nav>
        <div class="tab-content" id="nav-tabContent" data-bind="visible:editable">
          <div class="tab-pane fade show active g-pa-20" id="nav-info" role="tabpanel" aria-labelledby="nav-info-tab">

            <!-- Tag Input -->
            <div class="form-group g-mb-65" data-bind="visible:editable" style="display:none;">
              <label class="g-mb-10" for="inputGroup1_1">① Tags</label>
              <select id="select-tags" style="width: 100%;" class="g-brd-0 g-ma-5 g-pa-5"
                data-bind="value:selectedTags"></select>
              <small class="form-text text-muted g-font-size-default g-mt-10">We'll never share your email with anyone
                else.</small>
              <button class="g-pos-abs g-right-20 btn u-btn-outline-blue g-rounded-50 g-mr-10 g-mb-15"
                data-bind="visible:editable, click:saveOrUpdateTags">Update</button>
            </div>
            <!-- End Tag Input -->

            <label class="g-mb-10">② Shared Link</label>
            <div class="g-pos-rel g-mb-20 ">
              <input id="imageCopyLink"
                class="form-control form-control-md g-brd-gray-light-v7 g-brd-gray-light-v3 g-rounded-4 g-px-14 g-py-10"
                type="text" placeholder="LINK" data-bind="value:attachment.sharedLink.linkId">
              <em
                class="d-flex align-items-center g-absolute-centered--y g-right-15 g-font-style-normal g-color-gray-dark-v11">
                <span
                  class="g-pos-rel g-width-18 g-height-18 g-bg-secondary g-brd-around g-brd-secondary rounded-circle"
                  data-bind="visible: shared">
                  <i class="ti-check g-absolute-centered g-font-weight-800 g-font-size-8 g-color-white"
                    title="Confirmed"></i>
                </span>
              </em>
            </div>
            <button type="button" class="btn cur-p btn-outline-primary g-rounded-50"
              data-bind="invisible:shared, click:getSharedLink">
              <svg class="bi bi-link-45deg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor"
                xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M4.715 6.542L3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.001 1.001 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z" />
                <path
                  d="M5.712 6.96l.167-.167a1.99 1.99 0 0 1 .896-.518 1.99 1.99 0 0 1 .518-.896l.167-.167A3.004 3.004 0 0 0 6 5.499c-.22.46-.316.963-.288 1.46z" />
                <path
                  d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 0 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 0 0-4.243-4.243L6.586 4.672z" />
                <path
                  d="M10 9.5a2.99 2.99 0 0 0 .288-1.46l-.167.167a1.99 1.99 0 0 1-.896.518 1.99 1.99 0 0 1-.518.896l-.167.167A3.004 3.004 0 0 0 10 9.501z" />
              </svg>
              Create Shared Link</button>
            <button type="button" class="btn cur-p btn-outline-primary g-rounded-50"
              data-bind="visible:shared, click:deleteSharedLink">
              <svg class="bi bi-trash" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor"
                xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z" />
                <path fill-rule="evenodd"
                  d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z" />
              </svg>
              Delete Shared Link</button>
            <button class="btn btn-outline-secondary g-rounded-50 g-ml-10" type="button"
              data-clipboard-target="#imageCopyLink" data-bind="visible:shared">Copy Shared Link</button>
          </div>
          <div class="tab-pane fade" id="nav-property" role="tabpanel" aria-labelledby="nav-property-tab">
            <div id="property-grid" class="g-brd-0 tab-pane-grid"></div>
          </div>
          <div class="tab-pane fade" id="nav-permission" role="tabpanel" aria-labelledby="nav-permission-tab">

            <p>to be soon.</p>

          </div>
        </div>
      </div>
      <script id="no-tag-data-template" type="text/x-kendo-tmpl">
        # var value = instance.input.val(); #
        # var id = instance.element[0].id; #
        <div>
          <span >No data found. Do you want to add new item - '#: value #' ?
        </div>
        <br />
        <button class="btn btn-md u-btn-outline-darkgray g-mr-10 g-mb-15" onclick="addNewTag('#: id #', '#: value #')" ontouchend="addNewTag('#: id #', '#: value #')"><i class="fa fa-tags g-ml-3"></i> Add new tag</button>
      </script>
      <script type="text/x-kendo-template" id="name-column-template">
      <div class="media">
          <div class="d-flex">
          <!-- Figure Image -->
            <div class="g-width-100 g-width-"100--md g-width-100 g-height-100--md g-brd-2 g-brd-transparent g-brd-lightblue-v3--parent-opened g-mr-20--sm">
              <a class="fancybox" is-secure="true" data-fancybox="gallery" href="#= studio.ui.getAttachmentUrl(data) #" 
              data-caption="#if (tags !=null && tags.length>0 ) {#<span class='u-label g-rounded-3 g-bg-pink g-mr-10 g-mb-15'><i class='fa fa-tags g-mr-3'></i>#: tags #</span>#}#
              <br/> 
              #: name #  #= studio.ui.format.byte( size ) # #= studio.ui.format.date( modifiedDate , 'yyyy.MM.dd HH:MM') #">
              <figure class="g-pos-rel u-bg-overlay g-bg-black-opacity-0_1--after g-overflow-hidden">
              <img class="g-width-100 g-width-100--md g-width-100 g-height-100--md g-brd-2 g-brd-transparent g-brd-lightblue-v3--parent-opened g-mr-20--sm" 
              #if ( sharedLink!=null && sharedLink.publicShared ) { # 
              src="#= studio.ui.getAttachmentUrl(data, {thumbnail:true}) #"   
              #}else{#               
              data-retry="0" is-secure="true" secure-image="#= studio.ui.getAttachmentUrl(data, {thumbnail:true}) #"
              src="assets/static/images/no-image.jpg"
              #}#
              alt="#= name #">
              </figure> 
              </a>
            </div>
          <!-- Figure Image -->
          </div>
          <div class="media-body g-pl-10">
            <!-- Figure Info -->
            <a class="d-flex align-items-center u-link-v5 u-link-underline g-color-black g-color-lightblue-v3--hover g-color-lightblue-v3--opened" href="\#!" data-action="edit" data-object-id="#=attachmentId#">
              <h5 class="g-font-weight-300 g-mb-0">
              #if ( sharedLink!=null && sharedLink.publicShared ) { # 
                <svg class="bi bi-unlock c-red-500" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd" d="M9.655 8H2.333c-.264 0-.398.068-.471.121a.73.73 0 0 0-.224.296 1.626 1.626 0 0 0-.138.59V14c0 .342.076.531.14.635.064.106.151.18.256.237a1.122 1.122 0 0 0 .436.127l.013.001h7.322c.264 0 .398-.068.471-.121a.73.73 0 0 0 .224-.296 1.627 1.627 0 0 0 .138-.59V9c0-.342-.076-.531-.14-.635a.658.658 0 0 0-.255-.237A1.122 1.122 0 0 0 9.655 8zm.012-1H2.333C.5 7 .5 9 .5 9v5c0 2 1.833 2 1.833 2h7.334c1.833 0 1.833-2 1.833-2V9c0-2-1.833-2-1.833-2zM8.5 4a3.5 3.5 0 1 1 7 0v3h-1V4a2.5 2.5 0 0 0-5 0v3h-1V4z"/>
                </svg>
              # } else {#
                <svg class="bi bi-lock c-red-500" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd" d="M11.5 8h-7a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V9a1 1 0 0 0-1-1zm-7-1a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h7a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-7zm0-3a3.5 3.5 0 1 1 7 0v3h-1V4a2.5 2.5 0 0 0-5 0v3h-1V4z"/>
                </svg>
              #}#
              #= name #
              </h5> 
            </a> 
            #if ( sharedLink!=null ) { #
            <div class="input-group g-mt-5">
              <input type="text" class="form-control" id="copyLink_#= attachmentId #" value="#= sharedLink.linkId #" 
                placeholder="Image Link" aria-label=".." aria-describedby="button-addon4" readonly >
              <div class="input-group-append" id="button-addon4">
                <button class="btn btn-outline-secondary" type="button" data-clipboard-target="\#copyLink_#= attachmentId #">Copy Link</button>
              </div>
            </div>
            #}#
            #if ( tags != null ) { #
            <p class="g-font-weight-300 g-color-gray-dark-v6 g-mt-5 g-ml-10 g-mb-0" >
            #: tags #
            </p>
            #}#
            </div>
            <!-- End Figure Info -->
          </div>
      </div>
      </script>

      <script type="text/x-kendo-template" id="grid-toolbar-template">
      <div class="layer w-100">
        <div class="peers ai-c jc-sb fxw-nw">
          <div class="peer">
            <button type="button" class="btn cur-p btn-danger k-grid-add" data-bind="click:upload">
              <svg class="bi bi-cloud-upload" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path d="M4.887 6.2l-.964-.165A2.5 2.5 0 1 0 3.5 11H6v1H3.5a3.5 3.5 0 1 1 .59-6.95 5.002 5.002 0 1 1 9.804 1.98A2.501 2.501 0 0 1 13.5 12H10v-1h3.5a1.5 1.5 0 0 0 .237-2.981L12.7 7.854l.216-1.028a4 4 0 1 0-7.843-1.587l-.185.96z"/>
                <path fill-rule="evenodd" d="M5 8.854a.5.5 0 0 0 .707 0L8 6.56l2.293 2.293A.5.5 0 1 0 11 8.146L8.354 5.5a.5.5 0 0 0-.708 0L5 8.146a.5.5 0 0 0 0 .708z"/>
                <path fill-rule="evenodd" d="M8 6a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0v-8A.5.5 0 0 1 8 6z"/>
              </svg>
              New File</button>
          </div>
          <div class="peer"> 
            <button type="button" class="btn cur-p u-btn-outline-blue" data-bind="enabled:selected">
              <svg class="bi bi-tag" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M.5 2A1.5 1.5 0 0 1 2 .5h4.586a1.5 1.5 0 0 1 1.06.44l7 7a1.5 1.5 0 0 1 0 2.12l-4.585 4.586a1.5 1.5 0 0 1-2.122 0l-7-7A1.5 1.5 0 0 1 .5 6.586V2zM2 1.5a.5.5 0 0 0-.5.5v4.586a.5.5 0 0 0 .146.353l7 7a.5.5 0 0 0 .708 0l4.585-4.585a.5.5 0 0 0 0-.708l-7-7a.5.5 0 0 0-.353-.146H2z"/>
                <path fill-rule="evenodd" d="M2.5 4.5a2 2 0 1 1 4 0 2 2 0 0 1-4 0zm2-1a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
              </svg>
              Tags</button>
            <button type="button" class="btn cur-p btn-outline-primary">
              <svg class="bi bi-images" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M12.002 4h-10a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1zm-10-1a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-10z"/>
                <path d="M10.648 8.646a.5.5 0 0 1 .577-.093l1.777 1.947V14h-12v-1l2.646-2.354a.5.5 0 0 1 .63-.062l2.66 1.773 3.71-3.71z"/>
                <path fill-rule="evenodd" d="M4.502 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zM4 2h10a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1v1a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2h1a1 1 0 0 1 1-1z"/>
              </svg>
              Slide</button>
            <button type="button" class="btn cur-p u-btn-pink" data-bind="enabled:selected, click:delete">
              <svg class="bi bi-trash" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
              </svg>
              Delete</button>
          </div>
        </div>
      </div>  
      </script>
      <script type="text/x-kendo-template" id="user-column-template">
      <div class="media">
        <div class="d-flex align-self-center">
          <img class="g-width-36 g-height-36 g-rounded-50 g-mr-15" src="#= studio.services.accounts.getUserAvatarUrl( user.username ) #" >
        </div>
        <div class="media-body align-self-center text-left">#if ( !user.anonymous  && user.name != null ) {# #: user.name # #}#</div>
      </div>	
      </script>
      <!-- ### $App Screen Footer ### -->
      <%= require('html-loader!./include-footer.html') %>
    </div>
  </div>
</body>

</html>